{"version":3,"sources":["game/solve.js","game/elimination.js","game/Square.js","game/p5.js","game/game.js","state.js","components/Sidebar.js","components/CanvasDiv.js","components/App.js","index.js"],"names":["solve","game","time","m","n","A","matrix","pos","i","j","I","k","filter","x","forEach","buildAugmentedMatrix","length","pivots","isSolvable","lastPivotRow","elimination","pivotRow","findPivotInCol","swapRows","eliminateRows","startRow","col","y","pivotCol","timeEnd","buildEmpty","N","j_","sol","res","Square","this","w","h","p5","fill","getColor","rect","showSolution","solution","r","cx","cy","push","stroke","strokeWeight","circle","pop","editMode","toggleSquare","updateSolution","canvas","parent","updateSquares","gap","squares","width","height","size","initX","update","setup","parentNode","createCanvas","offsetWidth","offsetHeight","onselectstart","oncontextmenu","reset","draw","clear","getBoundingClientRect","resizeCanvas","checkWindowResize","mousePressed","e","type","checkMouseClick","mouseX","mouseY","windowResized","debug","state","initMatrix","isImpossible","setImpossibleGUI","newGame","updateN","updateM","tries","console","log","Math","floor","random","initP5","setupP5","label","useGlobalState","createGlobalState","openSidebar","Sidebar","opened","setEditMode","setShowSolution","useState","setImpossible","setM","setN","Div","cursor","Slider","value","aria-labelledby","step","marks","min","max","onChange","val","style","margin","Button","variant","color","onClick","Switch","checked","target","visibility","marginTop","styled","div","React","createRef","CanvasDiv","setOpenSidebar","portrait","useMediaQuery","useEffect","config","current","id","ref","openIcon","closeIcon","sidebarButton","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.63ac0fc6.chunk.js","sourcesContent":["import game from 'game/game'\r\nimport elimination from 'game/elimination'\r\n\r\nexport default function solve() {\r\n  game.time('solve')\r\n  let {m, n} = game\r\n  let A = buildAugmentedMatrix()\r\n  let [_, pivots, isSolvable] = elimination(A)\r\n  if(!isSolvable) {\r\n    game.timeEnd('solve')\r\n    return [buildEmpty(), true]\r\n  }\r\n  let x = [], N = A.length\r\n  // assign value to free variables\r\n  for(let j = 0; j < N; j++)\r\n    if(!(j in pivots))\r\n      x[j] = 0\r\n  // compute x\r\n  for(let j = N-1; j >= 0; j--) {\r\n    if(!(j in pivots)) continue\r\n    let i = pivots[j]\r\n    x[j] = A[i][N]\r\n    for(let j_ = j+1; j_ < N; j_++)\r\n      x[j] = (x[j] + A[i][j_] * x[j_]) % 2\r\n  }\r\n  // convert solution vector x to matrix\r\n  let sol = []\r\n  for(let i = 0; i < m; i++) {\r\n    sol[i] = []\r\n    for(let j = 0; j < n; j++)\r\n      sol[i][j] = x[i*n+j]\r\n  }\r\n  game.timeEnd('solve')\r\n  return [sol, false]\r\n}\r\n\r\nfunction buildAugmentedMatrix() {\r\n  const {m, n, matrix} = game\r\n  const pos = (i, j) => {\r\n    if(i < 0 || j < 0 || i >= m || j >= n) \r\n      return -1\r\n    return i*n + j\r\n  }\r\n  const A = []\r\n  for(let i = 0; i < m; i++) {\r\n    for(let j = 0; j < n; j++) {\r\n      let I = pos(i, j)\r\n      A[I] = []\r\n      for(let k = 0; k < m*n; k++)\r\n        A[I][k] = 0\r\n      ;[pos(i, j), pos(i-1, j), pos(i, j-1), pos(i+1, j), pos(i, j+1)]\r\n      .filter(x => x != -1).forEach(x => A[I][x] = 1)\r\n      A[I][m*n] = matrix[i][j]\r\n    }\r\n  }\r\n  return A\r\n}\r\n\r\nfunction buildEmpty() {\r\n  const {m, n} = game\r\n  let res = []\r\n  for(let i = 0; i < m; i++) {\r\n    res[i] = []\r\n    for(let j = 0; j < n; j++) {\r\n      res[i][j] = 0\r\n    }\r\n  }\r\n  return res\r\n}\r\n","// reduces the augmented matrix A to row echelon form with operations modulo 2\r\n// returns [reduced A, pivots, isSolvable]\r\nexport default function elimination(A) {\r\n  const m = A.length, n = A[0].length, pivots = {}\r\n  let isSolvable = true, lastPivotRow = -1\r\n  elimination:\r\n  for(let i = 0, j = 0; i < m && j < n-1; i++, j++) {\r\n    let pivotRow = findPivotInCol(i, j)\r\n    while(pivotRow == -1) {\r\n      if(++j >= n-1) break elimination\r\n      pivotRow = findPivotInCol(i, j)\r\n    }\r\n    swapRows(i, pivotRow)\r\n    eliminateRows(i, j)\r\n    lastPivotRow = pivots[j] = i\r\n  }\r\n  for(let i = lastPivotRow+1; i < m; i++) {\r\n    if(A[i][n-1] != 0) {\r\n      isSolvable = false\r\n      break\r\n    }\r\n  }\r\n  return [A, pivots, isSolvable]\r\n\r\n  // returns pivot row or -1 if no pivot found\r\n  function findPivotInCol(startRow, col) {\r\n    for(let i = startRow; i < m; i++)\r\n      if(A[i][col] != 0)\r\n        return i\r\n    return -1\r\n  }\r\n\r\n  function swapRows(x, y) {\r\n    [A[x], A[y]] = [A[y], A[x]]\r\n  }\r\n\r\n  function eliminateRows(pivotRow, pivotCol) {\r\n    for(let i = pivotRow+1; i < m; i++) {\r\n      if(A[i][pivotCol] == 0) continue\r\n      for(let j = pivotCol; j < n; j++)\r\n        A[i][j] = (A[i][j] + A[pivotRow][j]) % 2\r\n    }\r\n  }\r\n}\r\n","import game from 'game/game'\r\n\r\nexport default class Square {\r\n  constructor(i, j) {\r\n    this.x = this.y = this.w = this.h = 0\r\n    this.i = i\r\n    this.j = j\r\n  }\r\n  \r\n  update(x, y, w, h) {\r\n    this.x = x\r\n    this.y = y\r\n    this.w = w\r\n    this.h = h\r\n  }\r\n\r\n  draw(p5) {\r\n    p5.fill(this.getColor())\r\n    p5.rect(this.x, this.y, this.w, this.h)\r\n    if(game.showSolution && game.solution[this.i][this.j]) {\r\n      let r = .05 * this.w,\r\n      cx = this.x + this.w - r - .04*this.w,\r\n      cy = this.y + this.h - r - .04*this.h\r\n      p5.push()\r\n      p5.fill('#ff0000')\r\n      p5.stroke('#ffffff')\r\n      p5.strokeWeight(.2)\r\n      p5.circle(cx, cy, 2*r)\r\n      p5.pop()\r\n    }\r\n  }\r\n\r\n  checkMouseClick(x, y) {\r\n    if(x >= this.x && x <= this.x+this.w && y >= this.y && y <= this.y+this.h) {\r\n      const {m, n, editMode} = game\r\n      const {i, j} = this\r\n      game.toggleSquare(i, j)\r\n      if(!editMode) {\r\n        if(i-1 >= 0) game.toggleSquare(i-1, j)\r\n        if(j-1 >= 0) game.toggleSquare(i, j-1)\r\n        if(i+1 < m) game.toggleSquare(i+1, j)\r\n        if(j+1 < n) game.toggleSquare(i, j+1)\r\n      }\r\n      game.updateSolution()\r\n    }\r\n  }\r\n\r\n  getColor() {\r\n    switch(game.matrix[this.i][this.j]) {\r\n      case 0: return '#000000'\r\n      case 1: return '#f2fc32'\r\n      default: return '#ffffff'\r\n    }\r\n  }\r\n}","export default (p5, game) => {\r\n  let canvas, parent\r\n  p5.setup = () => {\r\n    parent = p5.canvas.parentNode\r\n    canvas = p5.createCanvas(parent.offsetWidth, parent.offsetHeight).canvas\r\n    canvas.onselectstart = () => false\r\n    canvas.oncontextmenu = () => false\r\n    game.reset()\r\n  }\r\n\r\n  p5.draw = () => {\r\n    p5.clear()\r\n    checkWindowResize()\r\n    let {m, n, squares} = game\r\n    for(let i = 0; i < m; i++) {\r\n      for(let j = 0; j < n; j++) {\r\n        squares[i][j].update(p5)\r\n        updateSquares()\r\n        squares[i][j].draw(p5)\r\n      }\r\n    }\r\n  }\r\n\r\n  p5.mousePressed = e => {\r\n    if(e.type != 'mousedown') \r\n      return true\r\n    let {m, n, squares} = game\r\n    for(let i = 0; i < m; i++) {\r\n      for(let j = 0; j < n; j++) {\r\n        if(squares[i] && squares[i][j])\r\n          squares[i][j].checkMouseClick(p5.mouseX, p5.mouseY)\r\n      }\r\n    }\r\n  }\r\n\r\n  p5.windowResized = () => {\r\n    let {width, height} = parent.getBoundingClientRect()\r\n    p5.resizeCanvas(width, height)\r\n  }\r\n\r\n  function updateSquares() {\r\n    let {gap, n, m, squares} = game\r\n    let {width, height} = p5\r\n    if(height/m < width/n) {\r\n      let size = height/m - gap - gap/m\r\n      let initX = (width - n*(size+gap) - gap) / 2 + gap\r\n      for(let i = 0, y = gap; i < m; i++, y += size+gap) {\r\n        for(let j = 0, x = initX; j < n; j++, x += size+gap) {\r\n          squares[i][j].update(x, y, size, size)\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      let size = width/n - gap - gap/n\r\n      let initY = (height - m*(size+gap) - gap) / 2 + gap\r\n      for(let i = 0, y = initY; i < m; i++, y += size+gap) {\r\n        for(let j = 0, x = gap; j < n; j++, x += size+gap) {\r\n          squares[i][j].update(x, y, size, size)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function checkWindowResize() {\r\n    let {width, height} = parent.getBoundingClientRect()\r\n    if(p5.width != width || p5.height != height) {\r\n      p5.resizeCanvas(width, height)\r\n    }\r\n  }\r\n}","import solve from 'game/solve'\r\nimport Square from 'game/Square'\r\nimport setupP5 from 'game/p5'\r\n\r\nconst game = {\r\n  debug: true,\r\n  m: 6,\r\n  n: 6,\r\n  showSolution: false,\r\n  editMode: false,\r\n  gap: 3,\r\n  state: 'PLAY',\r\n  initMatrix: [\r\n    [1,1,0,1,0,0],\r\n    [1,1,1,0,1,0],\r\n    [0,1,1,0,0,1],\r\n    [1,0,0,1,1,0],\r\n    [0,1,0,1,1,1],\r\n    [0,0,1,0,1,1]\r\n  ],\r\n  matrix: null,\r\n  squares: null,\r\n  solution: null,\r\n  isImpossible: false,\r\n  setImpossibleGUI: () => {},\r\n  updateSolution() {\r\n    [this.solution, this.isImpossible] = solve(this.matrix)\r\n    this.setImpossibleGUI(this.isImpossible)\r\n  },\r\n  reset() {\r\n    this.newGame()\r\n  },\r\n  updateN(n) {\r\n    this.n = n\r\n    this.newGame()\r\n  },\r\n  updateM(m) {\r\n    this.m = m\r\n    this.newGame()\r\n  },\r\n  newGame(initMatrix) {\r\n    let tries = 0\r\n    do {\r\n      this.updateSquares(initMatrix)\r\n    } while (this.isImpossible && ++tries < 250)\r\n    if(game.debug) console.log(`tries: ${tries}`)\r\n  },\r\n  updateSquares(initMatrix) {\r\n    this.matrix = []\r\n    this.squares = []\r\n    for(let i = 0; i < this.m; i++) {\r\n      this.matrix[i] = []\r\n      this.squares[i] = []\r\n      for(let j = 0; j < this.n; j++) {\r\n        this.matrix[i][j] = initMatrix ? initMatrix[i][j] : Math.floor(Math.random()*2)\r\n        this.squares[i][j] = new Square(i, j)\r\n      }\r\n    }\r\n    this.updateSolution()\r\n  },\r\n  toggleSquare(i, j) {\r\n    this.matrix[i][j] = (this.matrix[i][j] + 1) % 2\r\n  },\r\n  initP5(p5) {\r\n    setupP5(p5, this)\r\n  },\r\n  time(label) {\r\n    if(this.debug) console.time(label)\r\n  },\r\n  timeEnd(label) {\r\n    if(this.debug) console.timeEnd(label)\r\n  }\r\n}\r\n\r\nexport default game","import {createGlobalState} from 'react-hooks-global-state'\r\nimport game from 'game/game'\r\n\r\nexport const {useGlobalState} = createGlobalState({\r\n  openSidebar: false,\r\n  editMode: game.editMode,\r\n  showSolution: game.showSolution\r\n})\r\n","import React, {useState} from 'react'\r\nimport {Slider, Switch, Button} from '@material-ui/core'\r\nimport game from 'game/game'\r\nimport styled from 'styled-components'\r\nimport {useGlobalState} from 'state' \r\n\r\nexport default function Sidebar() {\r\n  const [opened, setOpened] = useGlobalState('openSidebar')\r\n  const [editMode, setEditMode] = useGlobalState('editMode')\r\n  const [showSolution, setShowSolution] = useGlobalState('showSolution')\r\n  const [isImpossible, setImpossible] = useState(game.isImpossible)\r\n  game.setImpossibleGUI = setImpossible\r\n  const [m, setM] = useState(game.m)\r\n  const [n, setN] = useState(game.n)\r\n  return <>\r\n    <Div opened={opened} cursor={editMode ? 'copy' : 'auto'}>\r\n      <h1>Lights Out!</h1>\r\n\r\n      <h2>Width: {n}</h2>\r\n      <Slider\r\n        value={n}\r\n        aria-labelledby=\"discrete-slider\"\r\n        // valueLabelDisplay=\"auto\"\r\n        step={1} marks min={1} max={10}\r\n        onChange={(e, val) => {\r\n          if(n == val) return\r\n          game.updateN(val)\r\n          setN(val)\r\n          setImpossible(game.isImpossible)\r\n        }}\r\n        style={{\r\n          width: '80%',\r\n          margin: '0 0 20px 0'\r\n        }}\r\n      />\r\n\r\n      <h2>Height: {m}</h2>\r\n      <Slider\r\n        value={m}\r\n        aria-labelledby=\"discrete-slider\"\r\n        step={1} marks min={1} max={10}\r\n        onChange={(e, val) => {\r\n          if(m == val) return\r\n          game.updateM(val)\r\n          setM(val)\r\n          setImpossible(game.isImpossible)\r\n        }}\r\n        style={{\r\n          width: '80%',\r\n          margin: '0 0 20px 0'\r\n        }}\r\n      />   \r\n      \r\n      <Button variant=\"outlined\" color=\"primary\" onClick={() => {\r\n        game.reset()\r\n        setM(game.m)\r\n        setN(game.n)\r\n        setShowSolution(game.showSolution)\r\n        setEditMode(game.editMode)\r\n        setImpossible(game.isImpossible)\r\n      }}>\r\n        Shuffle\r\n      </Button>\r\n\r\n      <h2>Show Solution</h2>\r\n      <div style={{margin: '0 0 13px 0'}}>\r\n        <Switch checked={showSolution} color=\"primary\" onChange={e => {\r\n          setShowSolution(e.target.checked)\r\n          game.showSolution = e.target.checked\r\n        }}/>\r\n      </div>\r\n\r\n      <h2>Edit Mode</h2>\r\n      <div style={{margin: '0 0 13px 0'}}>\r\n        <Switch checked={editMode} color=\"primary\" onChange={e => {\r\n          setEditMode(e.target.checked)\r\n          game.editMode = e.target.checked\r\n        }}/>\r\n      </div>\r\n\r\n      <h2 style={{\r\n        visibility: isImpossible ? 'visible' : 'hidden',\r\n        marginTop: '15px',\r\n        color: 'red'\r\n      }}>\r\n        No Solution!\r\n      </h2>\r\n\r\n    </Div>\r\n  </>\r\n}\r\n\r\nconst Div = styled.div`\r\n  flex: ${({opened}) => opened * 40};\r\n  background-color: #d4faef;\r\n  overflow-x: hidden;\r\n  transition: flex .75s;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: ${({cursor}) => cursor};\r\n\r\n  h1 {\r\n    margin: 15px 15px 30px 15px;\r\n    text-align: center;\r\n    font-size: 35px;\r\n  }\r\n\r\n  h2 {\r\n    margin: 0 0 0 0;\r\n    text-align: center;\r\n    // align-self: flex-start;\r\n  }\r\n\r\n  Switch {\r\n    margin: 0 0 20px 0;\r\n  }\r\n\r\n  Button {\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  ::-webkit-scrollbar {\r\n    width: 4px;\r\n    background-color: #F5F5F5;\r\n  }\r\n\r\n  ::-webkit-scrollbar-thumb {\r\n    background-color: #000000;\r\n    border: 2px solid #555555;\r\n  }\r\n`\r\n","import React, {useEffect} from 'react'\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight'\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft'\r\nimport KeyboardArrowUpIcon from '@material-ui/icons/KeyboardArrowUp'\r\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\nimport styled from 'styled-components'\r\nimport {useGlobalState} from 'state' \r\nimport p5 from 'p5'\r\nimport config from 'game/game'\r\n\r\nconst div = React.createRef()\r\n\r\nexport default function CanvasDiv() {\r\n  const [openSidebar, setOpenSidebar] = useGlobalState('openSidebar')\r\n  const [editMode] = useGlobalState('editMode')\r\n  const portrait = useMediaQuery('(orientation: portrait)')\r\n  \r\n  useEffect(() => {\r\n    new p5(p5 => {\r\n      config.initP5(p5)\r\n    }, div.current)\r\n  }, [])\r\n  return <>\r\n    <Div cursor={editMode ? 'copy' : 'auto'}>\r\n      <div id=\"canvasDiv\" ref={div}></div>\r\n      {sidebarButton()}\r\n      <p>:D</p>\r\n    </Div>\r\n  </>\r\n\r\n  function sidebarButton() {\r\n    const openIcon = portrait ? <KeyboardArrowDownIcon /> : <ChevronLeftIcon />\r\n    const closeIcon = portrait ? <KeyboardArrowUpIcon /> : <ChevronRightIcon />\r\n    return <>\r\n      <button onClick={() => setOpenSidebar(x => !x)}>\r\n        {openSidebar ? openIcon : closeIcon}\r\n      </button>\r\n    </>\r\n  }\r\n}\r\n\r\nconst Div = styled.div`\r\n  flex: 100;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: row;\r\n  cursor: ${({cursor}) => cursor};\r\n\r\n  #canvasDiv {\r\n    flex: 1;\r\n    background-color: #dbf7ff;\r\n    overflow: hidden;\r\n  }\r\n\r\n  button {\r\n    position: absolute;\r\n    margin: 3px;\r\n    background-color: #dbf7ff;\r\n    display: inline-block;\r\n    opacity: .7;\r\n    border: 0;\r\n    padding: 0;\r\n    z-index: 10;\r\n    outline: none;\r\n    width: 30px;\r\n    height: 30px;\r\n  }\r\n\r\n  button:hover {\r\n    outline: solid;\r\n    outline-color: #002fff;\r\n    outline-width: 1px;\r\n  }\r\n\r\n  p {\r\n    display: none;\r\n    position: absolute;\r\n    margin: 3px;\r\n    color: #ff0000;\r\n    background-color: transparent;\r\n    font-size: 25px;\r\n    bottom: 5px;\r\n    right: 5px;\r\n    opacity: .7;\r\n    border: 0;\r\n    padding: 0;\r\n    z-index: 10;\r\n    outline: none;\r\n  }\r\n\r\n`","import React from 'react'\nimport Sidebar from 'components/Sidebar'\nimport CanvasDiv from 'components/CanvasDiv'\n\nexport default function App() {\n  return <>\n    <Sidebar />\n    <CanvasDiv />\n  </>\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport 'index.css'\n\nimport App from 'components/App'\n\nReactDOM.render(<App/>, document.getElementById('root'))\n"],"sourceRoot":""}